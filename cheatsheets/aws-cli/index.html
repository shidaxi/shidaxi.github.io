<!doctype html><html lang=en><head><title>AWS CLI Cheatsheet :: Tech Memory</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="aws configure # aws cli related environement variables export AWS_PROFILE= export AWS_ACCESS_KEY_ID= export AWS_SECRET_ACCESS_KEY= export AWS_SESSION_TOKEN= export AWS_REGION=ap-southeast-1  export AWS_DEFAULT_OUTPUT=json export AWS_DEFAULT_REGION=ap-southeast-1 aws sts # get current identity aws sts get-caller-identity # assume role and set credentials to env variables, with jq ROLE_ARN=arn:aws:iam::000000000000:role/your-role eval $(aws sts assume-role \  --role-arn ${ROLE_ARN} \  --role-session-name sess-name \  | jq -r &amp;#39;.Credentials | &amp;#34;export AWS_ACCESS_KEY_ID=\(.AccessKeyId) AWS_SECRET_ACCESS_KEY=\(.SecretAccessKey) AWS_SESSION_TOKEN=\(.SessionToken)&amp;#34;&amp;#39;  ) # assume role and set credentials to env variables, with sed &amp;amp; awk ROLE_ARN=arn:aws:iam::000000000000:role/your-role eval $(aws sts assume-role \  --role-arn ${ROLE_ARN} \  --role-session-name sess-name \   | egrep &amp;#39;(SecretAccessKey|SessionToken|AccessKeyId)&amp;#39; \  | awk -F&amp;#39;&amp;#34;&amp;#39; &amp;#39;{print &amp;#34;export AWS&amp;#34;toupper(gensub(/([A-Z])/, &amp;#34;_\\1&amp;#34;, &amp;#34;g&amp;#34;,$2))&amp;#34;=&amp;#34;$4}&amp;#39;  ) aws ec2 # login to ec2 shell via session manager aws ssm start-session --target i-aaaaaaaaaaaaaaaaaa # port-forward aws s3 # list bucket aws s3 ls # rename folder aws s3 --recursive mv s3://your-bucket/path/to/foo s3://your-bucket/path/to/bar aws eks # check web identity env | grep AWS_ "><meta name=keywords content="aws,awscli,cheatsheet"><meta name=robots content="noodp"><link rel=canonical href=/cheatsheets/aws-cli/><link rel=stylesheet href=/assets/style.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/favicon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="AWS CLI Cheatsheet"><meta property="og:description" content="aws configure # aws cli related environement variables export AWS_PROFILE= export AWS_ACCESS_KEY_ID= export AWS_SECRET_ACCESS_KEY= export AWS_SESSION_TOKEN= export AWS_REGION=ap-southeast-1  export AWS_DEFAULT_OUTPUT=json export AWS_DEFAULT_REGION=ap-southeast-1 aws sts # get current identity aws sts get-caller-identity # assume role and set credentials to env variables, with jq ROLE_ARN=arn:aws:iam::000000000000:role/your-role eval $(aws sts assume-role \  --role-arn ${ROLE_ARN} \  --role-session-name sess-name \  | jq -r &amp;#39;.Credentials | &amp;#34;export AWS_ACCESS_KEY_ID=\(.AccessKeyId) AWS_SECRET_ACCESS_KEY=\(.SecretAccessKey) AWS_SESSION_TOKEN=\(.SessionToken)&amp;#34;&amp;#39;  ) # assume role and set credentials to env variables, with sed &amp;amp; awk ROLE_ARN=arn:aws:iam::000000000000:role/your-role eval $(aws sts assume-role \  --role-arn ${ROLE_ARN} \  --role-session-name sess-name \   | egrep &amp;#39;(SecretAccessKey|SessionToken|AccessKeyId)&amp;#39; \  | awk -F&amp;#39;&amp;#34;&amp;#39; &amp;#39;{print &amp;#34;export AWS&amp;#34;toupper(gensub(/([A-Z])/, &amp;#34;_\\1&amp;#34;, &amp;#34;g&amp;#34;,$2))&amp;#34;=&amp;#34;$4}&amp;#39;  ) aws ec2 # login to ec2 shell via session manager aws ssm start-session --target i-aaaaaaaaaaaaaaaaaa # port-forward aws s3 # list bucket aws s3 ls # rename folder aws s3 --recursive mv s3://your-bucket/path/to/foo s3://your-bucket/path/to/bar aws eks # check web identity env | grep AWS_ "><meta property="og:url" content="/cheatsheets/aws-cli/"><meta property="og:site_name" content="Tech Memory"><meta property="og:image" content="/images/cover-aws-cli-cheatsheet.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-01-23 00:00:00 +0800 +0800"></head><body class=orange><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>tech @ memory: ~ $</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>Posts</a></li><li><a href=/cheatsheets>Cheatsheets</a></li><li><a href=/tools>Tools</a></li><li><a href=/icon-collections>Icons</a></li><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>Posts</a></li><li><a href=/cheatsheets>Cheatsheets</a></li><li><a href=/tools>Tools</a></li><li><a href=/icon-collections>Icons</a></li><li><a href=/about>About</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/cheatsheets/aws-cli/>AWS CLI Cheatsheet</a></h1><div class=post-meta><span class=post-date>2021-01-23</span></div><span class=post-tags>#<a href=/tags/aws/>aws</a>&nbsp;
#<a href=/tags/awscli/>awscli</a>&nbsp;
#<a href=/tags/cheatsheet/>cheatsheet</a>&nbsp;</span>
<img src=/images/cover-aws-cli-cheatsheet.png class=post-cover alt="AWS CLI Cheatsheet" title="Cover Image"><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#aws-configure>aws configure</a></li><li><a href=#aws-sts>aws sts</a></li><li><a href=#aws-ec2>aws ec2</a></li><li><a href=#aws-s3>aws s3</a></li><li><a href=#aws-eks>aws eks</a></li></ul></nav></div><div class=post-content><div><h2 id=aws-configure>aws configure<a href=#aws-configure class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># aws cli related environement variables</span>
</span></span><span style=display:flex><span>export AWS_PROFILE<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>export AWS_ACCESS_KEY_ID<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>export AWS_SECRET_ACCESS_KEY<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>export AWS_SESSION_TOKEN<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>export AWS_REGION<span style=color:#f92672>=</span>ap-southeast-1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export AWS_DEFAULT_OUTPUT<span style=color:#f92672>=</span>json
</span></span><span style=display:flex><span>export AWS_DEFAULT_REGION<span style=color:#f92672>=</span>ap-southeast-1
</span></span></code></pre></div><h2 id=aws-sts>aws sts<a href=#aws-sts class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># get current identity</span>
</span></span><span style=display:flex><span>aws sts get-caller-identity
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># assume role and set credentials to env variables, with jq</span>
</span></span><span style=display:flex><span>ROLE_ARN<span style=color:#f92672>=</span>arn:aws:iam::000000000000:role/your-role
</span></span><span style=display:flex><span>eval <span style=color:#66d9ef>$(</span>aws sts assume-role <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        --role-arn <span style=color:#e6db74>${</span>ROLE_ARN<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        --role-session-name sess-name <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        | jq -r <span style=color:#e6db74>&#39;.Credentials | &#34;export AWS_ACCESS_KEY_ID=\(.AccessKeyId) AWS_SECRET_ACCESS_KEY=\(.SecretAccessKey) AWS_SESSION_TOKEN=\(.SessionToken)&#34;&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># assume role and set credentials to env variables, with sed &amp; awk</span>
</span></span><span style=display:flex><span>ROLE_ARN<span style=color:#f92672>=</span>arn:aws:iam::000000000000:role/your-role
</span></span><span style=display:flex><span>eval <span style=color:#66d9ef>$(</span>aws sts assume-role <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        --role-arn <span style=color:#e6db74>${</span>ROLE_ARN<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        --role-session-name sess-name <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span>        | egrep <span style=color:#e6db74>&#39;(SecretAccessKey|SessionToken|AccessKeyId)&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        | awk -F<span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#e6db74>&#39;{print &#34;export AWS&#34;toupper(gensub(/([A-Z])/, &#34;_\\1&#34;, &#34;g&#34;,$2))&#34;=&#34;$4}&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>)</span>
</span></span></code></pre></div><h2 id=aws-ec2>aws ec2<a href=#aws-ec2 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># login to ec2 shell via session manager</span>
</span></span><span style=display:flex><span>aws ssm start-session --target i-aaaaaaaaaaaaaaaaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># port-forward</span>
</span></span></code></pre></div><h2 id=aws-s3>aws s3<a href=#aws-s3 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># list bucket</span>
</span></span><span style=display:flex><span>aws s3 ls
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># rename folder</span>
</span></span><span style=display:flex><span>aws s3 --recursive mv s3://your-bucket/path/to/foo s3://your-bucket/path/to/bar
</span></span></code></pre></div><h2 id=aws-eks>aws eks<a href=#aws-eks class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># check web identity</span>
</span></span><span style=display:flex><span>env | grep AWS_
</span></span></code></pre></div></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>Â© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script></div></body></html>